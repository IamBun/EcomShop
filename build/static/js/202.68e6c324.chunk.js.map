{"version":3,"file":"static/js/202.68e6c324.chunk.js","mappings":"mOACA,EAAwB,qBAAxB,EAAoD,oB,uCC+GpD,EArGc,WACZ,IAAMA,GAAgBC,EAAAA,EAAAA,UAChBC,GAAmBD,EAAAA,EAAAA,UAEnBE,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MAEXC,EAAa,yCAAG,WAAOC,GAAC,wFAKkC,OAH9DA,EAAEC,iBAEIC,EAAuBV,EAAcW,QAAQC,MAC7CC,EAA0BX,EAAiBS,QAAQC,MAAM,EAAD,gBAE1CE,MAAMC,6CAA+C,CACrEC,YAAa,UACbC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,MAAOZ,EACPa,SAAUV,MAEX,KAAD,EAVO,OAAHW,EAAG,gBAYUA,EAAIC,OAAO,KAAD,EAAnB,OAAJC,EAAI,iBACWA,EAAKC,OAAO,KAAD,GAApB,GAANA,EAAM,OACA,CAAD,gBACsB,MAA/BC,EAAAA,GAAAA,MAAY,GAAD,OAAIF,EAAKG,UACd,IAAIC,MAAM,kBAAkB,KAAD,GAEF,OAAjCF,EAAAA,GAAAA,QAAc,mBAAmB,UACdd,MACjBC,kCAA6B,qBAAiBY,GAC9C,CACEX,YAAa,UACbE,QAAS,CACPa,cAAeL,EAAKM,SAGxB,KAAD,GARS,OAAJC,EAAI,iBAScA,EAAKR,OAAO,KAAD,GAA7BS,EAAS,OACfC,QAAQC,IAAI,YAAaF,GACzB/B,EACEkC,EAAAA,EAAAA,sBAAkC,CAAEC,aAAcJ,EAAUK,UAG9DC,aAAaC,QAAQ,YAAaP,EAAUK,QAE5CpC,EAASkC,EAAAA,EAAAA,WAAuB,CAAEJ,KAAMC,KACxC/B,EACEuC,EAAAA,EAAAA,MAAyB,CACvBC,KAAMjB,EAAKiB,KACXX,MAAON,EAAKM,MACZL,OAAQD,EAAKC,UAGjBiB,eAAeH,QAAQ,QAASf,EAAKM,OACrCY,eAAeH,QAAQ,SAAUf,EAAKiB,MACtCC,eAAeH,QAAQ,SAAUf,EAAKC,QACtCO,EAAUK,OAAS,GACjBC,aAAaC,QAAQ,OAAQrB,KAAKC,UAAUa,IAC9C7B,EAAS,KAAM,kDAEf8B,QAAQC,IAAI,EAAD,IAAQ,0DAEtB,gBA5DkB,sCA6DnB,OACE,iBAAKS,UAAWC,EAAc,WAC5B,gBAAKC,IAAKC,KACV,kBAAMC,SAAU1C,EAAesC,UAAWC,EAAa,WACrD,qCACA,kBAAOI,KAAK,OAAOC,YAAY,QAAQC,IAAKpD,KAC5C,kBACEkD,KAAK,WACLC,YAAY,WACZC,IAAKlD,KAEP,yCAEA,kDACsB,SAAC,KAAI,CAACmD,GAAG,YAAW,6BAG5C,SAAC,KAAc,CACbC,SAAS,aACTC,UAAW,IACXC,iBAAiB,EACjBC,aAAa,EACbC,cAAc,EACdC,KAAK,EACLC,kBAAgB,EAChBC,WAAS,EACTC,cAAY,EACZC,MAAM,YAId,ECxGA,EAJkB,WAChB,OAAO,SAAC,EAAK,GACf,C","sources":["webpack://myapp/./src/components/loginPage/login.module.css?01ae","components/loginPage/Login.js","page/LoginPage.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"login\":\"login_login__PwfxJ\",\"form\":\"login_form__0V1x8\"};","import img from \"../SRCIMG/banner1.jpg\";\r\nimport { json, Link } from \"react-router-dom\";\r\nimport { useRef } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { currentUserActions } from \"../../store/user\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport classes from \"./login.module.css\";\r\nimport { toast, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport { cartActions } from \"../../store/cartStore\";\r\n\r\nconst Login = () => {\r\n  const emailInputRef = useRef();\r\n  const passwordInputRef = useRef();\r\n\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const signInHandler = async (e) => {\r\n    //click login\r\n    e.preventDefault();\r\n\r\n    const enteredEmailInputRef = emailInputRef.current.value; //lay gia tri tu input\r\n    const enteredPasswordInputRef = passwordInputRef.current.value;\r\n    try {\r\n      const res = await fetch(process.env.REACT_APP_API_URL + \"/auth/login\", {\r\n        credentials: \"include\",\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          email: enteredEmailInputRef,\r\n          password: enteredPasswordInputRef,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n      const userId = await data.userId;\r\n      if (!userId) {\r\n        toast.error(`${data.message}`);\r\n        throw new Error(\"Login failed !\");\r\n      }\r\n      toast.success(\"Login success !\");\r\n      const cart = await fetch(\r\n        process.env.REACT_APP_API_URL + `/shop/cart/${userId}`,\r\n        {\r\n          credentials: \"include\",\r\n          headers: {\r\n            Authorization: data.token,\r\n          },\r\n        }\r\n      );\r\n      const cartTotal = await cart.json();\r\n      console.log(\"cartTotal\", cartTotal);\r\n      dispatch(\r\n        cartActions.changeProductQuantity({ totalProduct: cartTotal.length })\r\n      );\r\n\r\n      localStorage.setItem(\"cartTotal\", cartTotal.length);\r\n\r\n      dispatch(cartActions.changeCart({ cart: cartTotal }));\r\n      dispatch(\r\n        currentUserActions.login({\r\n          name: data.name,\r\n          token: data.token,\r\n          userId: data.userId,\r\n        })\r\n      ); // gui dispatch de luu email user hien tai\r\n      sessionStorage.setItem(\"token\", data.token);\r\n      sessionStorage.setItem(\"isUser\", data.name);\r\n      sessionStorage.setItem(\"userId\", data.userId);\r\n      cartTotal.length > 0 &&\r\n        localStorage.setItem(\"cart\", JSON.stringify(cartTotal));\r\n      navigate(\"/\"); //dang nhap thanh cong, chuyen trang home\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  return (\r\n    <div className={classes.login}>\r\n      <img src={img}></img>\r\n      <form onSubmit={signInHandler} className={classes.form}>\r\n        <h1>Sign In</h1>\r\n        <input type=\"text\" placeholder=\"Email\" ref={emailInputRef}></input>\r\n        <input\r\n          type=\"password\"\r\n          placeholder=\"Password\"\r\n          ref={passwordInputRef}\r\n        ></input>\r\n        <button>SIGN IN</button>\r\n        {/* Goi y chua co tai khoan thi chuyen den trang dang ky  */}\r\n        <h3>\r\n          Create an account ? <Link to=\"/register\"> Sign up</Link>\r\n        </h3>\r\n      </form>\r\n      <ToastContainer\r\n        position=\"top-center\"\r\n        autoClose={2000}\r\n        hideProgressBar={false}\r\n        newestOnTop={false}\r\n        closeOnClick={false}\r\n        rtl={false}\r\n        pauseOnFocusLoss\r\n        draggable\r\n        pauseOnHover\r\n        theme=\"light\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import Login from \"../components/loginPage/Login\";\r\n\r\nconst LoginPage = () => {\r\n  return <Login />;\r\n};\r\n\r\nexport default LoginPage;\r\n"],"names":["emailInputRef","useRef","passwordInputRef","dispatch","useDispatch","navigate","useNavigate","signInHandler","e","preventDefault","enteredEmailInputRef","current","value","enteredPasswordInputRef","fetch","process","credentials","method","headers","body","JSON","stringify","email","password","res","json","data","userId","toast","message","Error","Authorization","token","cart","cartTotal","console","log","cartActions","totalProduct","length","localStorage","setItem","currentUserActions","name","sessionStorage","className","classes","src","img","onSubmit","type","placeholder","ref","to","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme"],"sourceRoot":""}